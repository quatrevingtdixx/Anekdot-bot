async def post_anekdot():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∞–Ω–µ–∫–¥–æ—Ç–∞ - –ø—É–±–ª–∏–∫—É–µ—Ç –¢–û–õ–¨–ö–û –û–î–ò–ù –∞–Ω–µ–∫–¥–æ—Ç –∑–∞ –∑–∞–ø—É—Å–∫"""
    try:
        print("üìñ –ß–∏—Ç–∞—é —Ñ–∞–π–ª —Å –∞–Ω–µ–∫–¥–æ—Ç–∞–º–∏...")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
        if not os.path.exists('anekdots.csv'):
            print("‚ùå –§–∞–π–ª anekdots.csv –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            if MY_CHAT_ID and BOT_TOKEN:
                await send_telegram_notification("‚ùå –û–®–ò–ë–ö–ê: –§–∞–π–ª anekdots.csv –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            return False, "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
        
        # –ß–∏—Ç–∞–µ–º CSV, —Å–æ—Ö—Ä–∞–Ω—è—è –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        df = pd.read_csv('anekdots.csv', dtype=str, keep_default_na=False)
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –î–û –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        total = len(df)
        published_before = df['–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω?'].eq('–î–∞').sum()
        remaining_before = total - published_before
        
        print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –í—Å–µ–≥–æ –∞–Ω–µ–∫–¥–æ—Ç–æ–≤: {total}, –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {published_before}, –û—Å—Ç–∞–ª–æ—Å—å: {remaining_before}")
        
        # –ï—Å–ª–∏ –≤—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã
        if remaining_before == 0:
            print("üéâ –í—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã!")
            if MY_CHAT_ID and BOT_TOKEN:
                await send_telegram_notification(
                    "üéâ –í–°–ï –ê–ù–ï–ö–î–û–¢–´ –£–ñ–ï –û–ü–£–ë–õ–ò–ö–û–í–ê–ù–´!\n\n"
                    f"–í—Å–µ–≥–æ –∞–Ω–µ–∫–¥–æ—Ç–æ–≤: {total}\n"
                    "–î–æ–±–∞–≤—å –Ω–æ–≤—ã–µ –∞–Ω–µ–∫–¥–æ—Ç—ã –≤ —Ñ–∞–π–ª anekdots.csv\n"
                    "–∏–ª–∏ —É–¥–∞–ª–∏ –æ—Ç–º–µ—Ç–∫–∏ '–î–∞' –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω?'"
                )
            return True, "–í—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã"
        
        # –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ù–ï –ü–£–ë–õ–ò–ö–£–ï–ú –°–†–ê–ó–£ –í–°–ï –ê–ù–ï–ö–î–û–¢–´!
        # –ù–∞—Ö–æ–¥–∏–º –ü–ï–†–í–´–ô –Ω–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–µ–∫–¥–æ—Ç
        for i, row in df.iterrows():
            if row.get('–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω?', '').strip() != '–î–∞':
                joke = str(row['–¢–µ–∫—Å—Ç –∞–Ω–µ–∫–¥–æ—Ç–∞']).strip()
                
                if not joke or joke.lower() == 'nan':
                    continue
                
                # –ü—É–±–ª–∏–∫—É–µ–º –¢–û–õ–¨–ö–û –≠–¢–û–¢ –∞–Ω–µ–∫–¥–æ—Ç
                print(f"üì§ –ü—É–±–ª–∏–∫—É—é –∞–Ω–µ–∫–¥–æ—Ç #{i+1}...")
                bot = Bot(token=BOT_TOKEN)
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–µ–∫–¥–æ—Ç –≤ –∫–∞–Ω–∞–ª
                await bot.send_message(chat_id=CHANNEL_ID, text=joke)
                
                # –û–±–Ω–æ–≤–ª—è–µ–º CSV - –æ—Ç–º–µ—á–∞–µ–º –¢–û–õ–¨–ö–û –≠–¢–û–¢ –∞–Ω–µ–∫–¥–æ—Ç
                current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                df.at[i, '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω?'] = '–î–∞'
                df.at[i, '–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏'] = current_time
                df.to_csv('anekdots.csv', index=False, encoding='utf-8')
                
                # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ü–û–°–õ–ï –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
                published_after = df['–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω?'].eq('–î–∞').sum()
                remaining_after = total - published_after
                
                # –õ–æ–≥–∏—Ä—É–µ–º
                joke_preview = joke.replace('\n', ' ')[:80]
                print(f"‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –∞–Ω–µ–∫–¥–æ—Ç #{i+1}")
                print(f"   –¢–µ–∫—Å—Ç: {joke_preview}...")
                print(f"   –í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: {current_time}")
                print(f"   –û—Å—Ç–∞–ª–æ—Å—å –∞–Ω–µ–∫–¥–æ—Ç–æ–≤: {remaining_after}")
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –º–∞–ª–æ –æ—Å—Ç–∞–ª–æ—Å—å
                if 1 <= remaining_after <= 3 and MY_CHAT_ID and BOT_TOKEN:
                    await send_telegram_notification(
                        f"üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –∞–Ω–µ–∫–¥–æ—Ç #{i+1}\n"
                        f"üìÖ {current_time}\n"
                        f"‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å –≤—Å–µ–≥–æ {remaining_after} –∞–Ω–µ–∫–¥–æ—Ç–æ–≤!"
                    )
                elif MY_CHAT_ID and BOT_TOKEN:
                    await send_telegram_notification(
                        f"üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –∞–Ω–µ–∫–¥–æ—Ç #{i+1}\n"
                        f"üìÖ {current_time}\n"
                        f"üìä –û—Å—Ç–∞–ª–æ—Å—å: {remaining_after}/{total}"
                    )
                
                return True, f"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –∞–Ω–µ–∫–¥–æ—Ç #{i+1}"
        
        # –ï—Å–ª–∏ –¥–æ—à–ª–∏ —Å—é–¥–∞, –∑–Ω–∞—á–∏—Ç –≤—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã
        # (—ç—Ç–æ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
        print("‚ÑπÔ∏è –í—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ")
        return True, "–í—Å–µ –∞–Ω–µ–∫–¥–æ—Ç—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã"
        
    except KeyError as e:
        error_msg = f"‚ùå –û—à–∏–±–∫–∞ –≤ CSV: –Ω–µ—Ç —Å—Ç–æ–ª–±—Ü–∞ {e}"
        print(error_msg)
        if MY_CHAT_ID and BOT_TOKEN:
            await send_telegram_notification(f"‚ùå –û–®–ò–ë–ö–ê –í CSV: –Ω–µ—Ç —Å—Ç–æ–ª–±—Ü–∞ {e}")
        return False, error_msg
    except Exception as e:
        error_msg = f"‚ùå –û—à–∏–±–∫–∞: {type(e).__name__}: {e}"
        print(error_msg)
        if MY_CHAT_ID and BOT_TOKEN:
            await send_telegram_notification(f"‚ùå –û–®–ò–ë–ö–ê –ë–û–¢–ê: {type(e).__name__}: {e}")
        return False, error_msg
